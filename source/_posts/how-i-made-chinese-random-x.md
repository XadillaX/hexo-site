title: 我是如何实现简单的随机中文名生成器的（Node 版）
date: 2014-09-01 20:36:33
tags: [ NodeJS, 中文名, 中文技能 ]
category: NodeJS
---

## 序

最近闲着蛋疼实现了两个库。

+ 随机生成中文名字
+ 随机生成中文技能名

我当然不会说去用各种人工智能去实现一个强大的的解析器然后生成，也不会说用一个非常庞大如搜狗拼音的姓名库来随机获取——我只是偶然间知道蘑菇街小侠节一个混战 PK 的 Demo 编写比赛，闲来无聊随便写写，然而这其中我需要随机给 Bot 起名以及技能起名而用到的库。

不需要有多少正确性——这两个库的结果经常出现非常奇葩的名字，让人哭笑不得，但是我要的就是这种效果。

## 结果示范

就两个库，我各生成一批名字以示效果。

### Chinese Random Name

```
阙造
广锡一
席寺
扶驾
郑萱黄
林樊牵
孟登元
鱼彰
皮忧暑
左稗
宦醇
糜弋招
席准
方抑
乌泔
苗鲁
孟候依
龙珠饯
洪打鹰
缪负铎
```

### Chinese Random SKill

```
地永心法
缨枪诀
冉腿
尼逻心法
奠拳谱
曲掌法
始刺
娘桶撷刀
璋瑾单养刀
銎刀
励俭驿媛心诀
瞻驰刀诀
晏协骅腿
示嫩帐羽刀诀
赛勘神体刀诀
铸爱指
施净琮萍棍
泊临惇枪诀
我道六分枪
残亭求拳谱
```

## 解析

实际上无论是起名还是技能名，都用了一个相同的起名字库和一段差不多的复用代码（虽然没有真正意义上的复用，只是复制粘贴而已，谁让他们是两个库呢，已经很简单了，我总不能再给他们搞一个依赖出来吧？）

### 起姓

关于 `chinese-random-name` 中的姓氏，我找了一个中国百家姓（包括复姓）比较全的词库。

> [词库链接](https://github.com/XadillaX/chinese-random-name/blob/master/dict/f.dict)

比较幸运，我找到的时候已经是这么分段分好了。我也没有详细做研究，随便给了不同的段不同的权值，当然越前面的段权值越高，被随机到的可能性越大。

首先用 `split` 来分割不同段：

```javascript
dict = dict.split("\n\n");
```

对于每一段来说通过 `Array.reduce` (详见 [SugarJs](https://github.com/andrewplummer/Sugar/blob/master/lib/es5.js#L287)) 来分割成行再成字。

看字典一共有 6 大段，每段的权值分别为：

```javascript
const weights = [ 100, 70, 10, 5, 1, 1 ];
```

然后每个字都有一个其权值区间，是累加上去的。

最后获取姓的时候随机生成一个在总区间内的数字，然后看看数字在哪个姓的区间内，就返回这个姓。

### 技能后缀

关于 `chinese-random-skill` 中的技能后缀，我偷懒了。因为那个时候 Demo 就快 Deadline 了，所以随便糊弄了一下——直接把印象里面比较熟的后缀写上去了事，也不给权值了。

```javascript
var suffix = [
    "剑", "剑法", "剑谱", "剑诀",
    "枪", "枪法", "枪诀",
    "拳", "拳法", "拳谱",
    "刀", "刀法", "刀谱", "刀诀",
    "斩", "刺", "大法", "心诀", "心法", "诀", "宝典",
    "棍", "棍法", "棍谱", "棍诀",
    "指", "掌", "掌法", "腿", "攻", "钩"
];
```

### 共用部分

名字主体为两个包的共用部分。

实际上他们依赖于一个特定款式的字库——我也就网上随便那么一搜。

> [字库链接](https://github.com/XadillaX/chinese-random-name/blob/master/dict/n.dict)

它每一行的结构一样：

```
Number UniChar UniChar：String
```

其中第一个数字我目测是繁体的笔画数，比如 899 行的 `书` 繁体就是 `书`，数一下的确是 10 划。

第二个就是字本体，第三个是该字的五行属性，最后是这个字在什么什么命数（请不要迷信）描述。

为了让名字看起来稍微正常点（只是稍微而已），我尽可能让同属性的字在一块儿，于是有了以下组合：

+ 金金
+ 木木
+ 水水
+ 火火
+ 土土

[这些字](https://github.com/XadillaX/chinese-random-name/blob/master/lib/name.js#L41)凑在一起的权值为 100。

然后隔一个属性的话是相克的，我不懂什么起名大法什么的，只是用膝盖想了下相克的属性不好起名吧（猜错了不要怨我），于是给了 20 的权值。

至于隔壁属性，是相生吧？于是给了 50 权值。

对于三个字的起名来说，也是用了类似的方法给权值，具体可以参考代码。

总之就是根据其两两之间的五行关系来起名的，听起来还是有那么点道理的。

哈哈，权当玩的，认真你就输了。

### 综合说明

上面的分步做完了，然后真·生成名字的步骤是：

随机生成一个姓（或者技能后缀），然后按照某个权值随机生成一个数字代表剩下的名字的长度，然后随机生成一串该长度的名字即可。

最后拼接上去就 OK 了。

## 无节操小广告

最后还是贴一下两个包的 repo 地址吧：

> + [Chinese Random Name](https://github.com/XadillaX/chinese-random-name)
> + [Chinese Random Skill](https://github.com/XadillaX/chinese-random-skill)

以及安装的话照下去弄就好了

```sh
$ npm install chinese-random-name
$ npm install chinese-random-skill
```

`README` 文件两个包都有。


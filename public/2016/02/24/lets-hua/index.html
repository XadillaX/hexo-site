<!DOCTYPE html><html class="han-init" lang="zh-Hant"><head><meta name="author" content="死月·吃圡蕾特"><meta name="description" itemprop="description" content="起因起因是我一个叫『小龙』的好基友由于某些原因离职去了一家跟阿里一样有着『花名文化』的公司，于是开始为花名犯愁。
结合之前妹纸『弍纾』在起花名的时候也遇到了同样的困扰，于是决定用 Node.js 写个『一本正经乱起花名』的程序。
准备Chinese Random Name首先起花名的原理就是胡乱随机"><link rel="alternative" href="/atom.xml" title="艾克斯の编码者" type="application/atom+xml"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>让我们一起来起花名吧 · 一个伪宅级别的码畜。</title><link rel="stylesheet" type="text/css" href="/font/fantasque_sans_mono/stylesheet.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/webicons/2.0.0/webicons.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/Han/3.3.0/han.min.css"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/highlight.js/9.9.0/styles/gruvbox-dark.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><header><a href="/"><img class="logo" src="/images/avatar.gif" alt="艾克斯の编码者" title="艾克斯の编码者"></a><h1><a href="/" alt="艾克斯の编码者" title="艾克斯の编码者">艾克斯の编码者</a></h1><p>一个伪宅级别的码畜。</p><nav><ul><li><a href="/" alt="首页" title="首页">首页</a></li><li><a href="/pigeonhole" alt="归档" title="归档">归档</a></li><li><a href="/links" alt="链接" title="链接">链接</a></li><li><a href="/curriculumvitae" alt="关于" title="关于">关于</a></li></ul><div class="xnews-icon"><a target="_blank" href="https://xcoder.in/atom.xml">&#xe621;</a><a target="_blank" href="https://github.com/XadillaX" style="position: relative; top: -2px;">&#xe735;</a><a target="_blank" href="https://www.zhihu.com/people/xadillax">&#xe63f;</a><a target="_blank" href="https://weibo.com/xadillax" style="position: relative; top: -2px;">&#xe603;</a></div></nav><div class="space"></div></header><main><article class="full"><h1>让我们一起来起花名吧</h1><span class="post-meta">写于<time> 2016 年 02 月 24 日 13 时 40 分</time><br>更新于<time> 2021 年 05 月 19 日 15 时 15 分</time></span><div class="article-toc"><strong>大纲</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">2.</span> <span class="toc-text">准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Chinese-Random-Name"><span class="toc-number">2.1.</span> <span class="toc-text">Chinese Random Name</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.1.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.2.</span> <span class="toc-text">高级用法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nomnom"><span class="toc-number">2.2.</span> <span class="toc-text">Nomnom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Colorful"><span class="toc-number">2.3.</span> <span class="toc-text">Colorful</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Is-Chinese"><span class="toc-number">2.4.</span> <span class="toc-text">Is Chinese</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88"><span class="toc-number">2.5.</span> <span class="toc-text">集合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%B7%A5"><span class="toc-number">3.</span> <span class="toc-text">开工</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text">解析命令行参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%B1%E5%90%8D%E7%B1%BB"><span class="toc-number">3.2.</span> <span class="toc-text">花名类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text">构造函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E8%8A%B1%E5%90%8D"><span class="toc-number">3.2.2.</span> <span class="toc-text">生成一个花名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90-Count-%E4%B8%AA%E8%8A%B1%E5%90%8D"><span class="toc-number">3.2.3.</span> <span class="toc-text">生成 Count 个花名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CLI-%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">CLI 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%A5%E8%B1%86%E9%BA%BB%E8%A2%8B%EF%BC%81"><span class="toc-number">3.3.1.</span> <span class="toc-text">桥豆麻袋！</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B6%E6%8B%BE"><span class="toc-number">4.</span> <span class="toc-text">收拾</span></a></li></ol></div><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>起因是我一个叫『小龙』的好基友由于某些原因离职去了一家跟阿里一样有着『花名文化』的公司，于是开始为花名犯愁。</p>
<p>结合之前妹纸『弍纾』在起花名的时候也遇到了同样的困扰，于是决定用 Node.js 写个『一本正经乱起花名』的程序。</p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="Chinese-Random-Name"><a href="#Chinese-Random-Name" class="headerlink" title="Chinese Random Name"></a>Chinese Random Name</h3><p>首先起花名的原理就是胡乱随机一串字出来胡乱拼。</p>
<p>于是准备应该有 <a target="_blank" rel="noopener" href="https://github.com/XadillaX/chinese-random-name">chinese-random-name</a>，一个随机生成中文名的包。</p>
<p>使用它很简单，先把它 <code>require</code> 进来：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> randomName = <span class="built_in">require</span>(<span class="string">&quot;chinese-random-name&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>如果你需要随机生成一个名字只需要 <code>randomName.generate()</code> 就可以了；如果你要随机一个姓那么就 <code>randomName.surnames.getOne()</code>；如果你只需要获得名字，这里面就有点门道了。</p>
<h4 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h4><p>你可以随机生成一个名（不带姓的） <code>randomName.names.get()</code>；你也可以指定名字的字数，一二三：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">randomName.names.get1();</span><br><span class="line">randomName.names.get2();</span><br><span class="line">randomName.names.get3();</span><br></pre></td></tr></table></figure>

<p>或者！</p>
<p>又或者！</p>
<p>然后或者！</p>
<p>你可以指定每个字的五行哦！</p>
<p>什么意思呢？比如你想给孩子起个名，然后孩子命里五行缺金，那么就可以：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">randomName.names.get2(<span class="string">&quot;金金&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>然后你就可能得到一个『<strong>紫铨</strong>』，两个字都是属金的。那么如果你孩子姓李，就叫李紫铨；如果孩子姓王，就叫王紫铨；如果姓爱新觉罗，那么就叫爱新觉罗·紫铨。</p>
<p>有木有想给我装得这个逼打个 82 分呢？剩下的就交给 666 吧。(ง •̀_•́)ง</p>
<h3 id="Nomnom"><a href="#Nomnom" class="headerlink" title="Nomnom"></a>Nomnom</h3><p>这个包是用来解析命令行参数的。虽然市面上有挺多别的的，比如 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/commander">commander</a> 等，不过我还是最习惯 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/nomnom">nomnom</a>，用称手了就不想换了。</p>
<p>虽然它的 GitHub Repo 下面有这么一段话。</p>
<blockquote>
<p>Nomnom is deprecated. Check out <a target="_blank" rel="noopener" href="https://github.com/tj/commander.js">https://github.com/tj/commander.js</a>, which should have most, if not all of the capability that nomnom had. Thank you!</p>
</blockquote>
<p>不过再怎么说 nomnom 也是当年 <a target="_blank" rel="noopener" href="https://github.com/substack/node-optimist">substack</a> 大神推荐的啊。(ಡωಡ)</p>
<h3 id="Colorful"><a href="#Colorful" class="headerlink" title="Colorful"></a>Colorful</h3><p>这个包是用来上色的。</p>
<p>毕竟五行是有颜色的哇。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> color = <span class="built_in">require</span>(<span class="string">&quot;colorful&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(color.red(<span class="string">&quot;（*/∇＼*）&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>那么在你的终端就好看到一个红色的 <code>（*/∇＼*）</code>。</p>
<h3 id="Is-Chinese"><a href="#Is-Chinese" class="headerlink" title="Is Chinese"></a>Is Chinese</h3><p>用来判断是不是中文的包。</p>
<p>作为一个起名的命令行程序，你总得好好传参才行吧，总不能你随便传个咸鸭蛋🐣我也好好处理吧。</p>
<p>于是就用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/is-chinese">is-chinese</a> 来判断某个字符串是不是纯中文。</p>
<p>这个包是由前阿里小伙伴，CNode 站长<a target="_blank" rel="noopener" href="https://github.com/alsotang">唐少</a>写的。</p>
<p>用起来也很简单，只要 <code>isChinese(&quot;什么你要判断什么&quot;)</code> 就可以了。</p>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ npm install --save -d chinese-random-name</span><br><span class="line">$ npm install --save -d nomnom</span><br><span class="line">$ npm install --save -d colorful</span><br><span class="line">$ npm install --save -d is-chinese</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>chinese-random-name</strong>: <a target="_blank" rel="noopener" href="https://github.com/XadillaX/chinese-random-name">https://github.com/XadillaX/chinese-random-name</a></li>
<li><strong>nomnom</strong>: <a target="_blank" rel="noopener" href="https://github.com/harthur/nomnom">https://github.com/harthur/nomnom</a></li>
<li><strong>colorful</strong>: <a target="_blank" rel="noopener" href="https://github.com/lepture/colorful">https://github.com/lepture/colorful</a></li>
<li><strong>is-chinese</strong>: <a target="_blank" rel="noopener" href="https://github.com/alsotang/is-chinese">https://github.com/alsotang/is-chinese</a></li>
</ul>
<h2 id="开工"><a href="#开工" class="headerlink" title="开工"></a>开工</h2><p>其结果在<a target="_blank" rel="noopener" href="https://github.com/BoogeeDoo/hua">这里</a>。</p>
<h3 id="解析命令行参数"><a href="#解析命令行参数" class="headerlink" title="解析命令行参数"></a>解析命令行参数</h3><p>首先效果是这样的：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ hua --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">Usage: hua [options]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">-p PREFIX, --prefix PREFIX          to specify a prefix.</span><br><span class="line">-s SUFFIX, --suffix SUFFIX          to specify a suffix.</span><br><span class="line">-5 WUXING, --five-elements WUXING   the file elements (Wuxing) of huaming.</span><br><span class="line">-c COUNT, --count COUNT             the count of huaming  [10]</span><br></pre></td></tr></table></figure>

<p>使用者可以自己想一个前缀或者后缀，然后自定义（或者也可以不指定）两个字的五行，以及指定一次性生成多少个花名。</p>
<p>比如想要生成以 <code>龙</code> 字为前缀的花名，就可以 <code>$ hua --prefix 龙</code>，得到结果可以是这样的：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">* 龙幼</span><br><span class="line">* 龙巡</span><br><span class="line">* 龙躬</span><br><span class="line">* 龙仇</span><br><span class="line">* 龙锤</span><br><span class="line">* 龙镒</span><br><span class="line">* 龙拾</span><br><span class="line">* 龙央</span><br><span class="line">* 龙些</span><br><span class="line">* 龙悠</span><br></pre></td></tr></table></figure>

<p>如果想两个字分别所属金和谁，就可以 <code>$ hua --five-elements 金水</code> 来起花名：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">* 倩娥</span><br><span class="line">* 雀效</span><br><span class="line">* 黍棓</span><br><span class="line">* 姹溶</span><br><span class="line">* 馨沙</span><br><span class="line">* 宫闲</span><br><span class="line">* 裕混</span><br><span class="line">* 俗封</span><br><span class="line">* 绸娥</span><br><span class="line">* 瑞淦</span><br></pre></td></tr></table></figure>

<p>想要得到这样一个命令行参数，我们可以用 <code>nomnom</code> 来解决。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> opts = <span class="built_in">require</span>(<span class="string">&quot;nomnom&quot;</span>)</span><br><span class="line">    .script(<span class="string">&quot;hua&quot;</span>)</span><br><span class="line">    .option(<span class="string">&quot;prefix&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">abbr</span>: <span class="string">&quot;p&quot;</span>,</span><br><span class="line">        <span class="attr">help</span>: <span class="string">&quot;to specify a prefix.&quot;</span>,</span><br><span class="line">        <span class="attr">metavar</span>: <span class="string">&quot;PREFIX&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .option(<span class="string">&quot;suffix&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">abbr</span>: <span class="string">&quot;s&quot;</span>,</span><br><span class="line">        <span class="attr">help</span>: <span class="string">&quot;to specify a suffix.&quot;</span>,</span><br><span class="line">        <span class="attr">metavar</span>: <span class="string">&quot;SUFFIX&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .option(<span class="string">&quot;five-elements&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">abbr</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">        <span class="attr">help</span>: <span class="string">&quot;the file elements (Wuxing) of huaming.&quot;</span>,</span><br><span class="line">        <span class="attr">metavar</span>: <span class="string">&quot;WUXING&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .option(<span class="string">&quot;count&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">abbr</span>: <span class="string">&quot;c&quot;</span>,</span><br><span class="line">        <span class="attr">help</span>: <span class="string">&quot;the count of huaming&quot;</span>,</span><br><span class="line">        <span class="attr">metavar</span>: <span class="string">&quot;COUNT&quot;</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="number">10</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .parse();</span><br></pre></td></tr></table></figure>

<p>上面的这段代码分别指定了脚本名为 <code>hua</code>，然后指定了 <code>prefix</code> / <code>suffix</code> / <code>five-elements</code> 和 <code>count</code> 四个参数，并把解析好的参数赋值给 <code>opts</code> 变量。</p>
<blockquote>
<p>由于我希望这个包在通常的 Node.js 下都可以跑，所以没有用 <code>let</code> 之类的东西。</p>
</blockquote>
<h3 id="花名类"><a href="#花名类" class="headerlink" title="花名类"></a>花名类</h3><p>接下去要写一个花名类，这个类不只是可以在 CLI 之中使用，也可以让别人作为一个包来引入。然后实际上这个类就是要对 <code>chinese-random-name</code> 进行一个封装。</p>
<h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Hua = <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.options = options;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do something...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>首先这个 <code>options</code> 就是之前由 <code>nomnom</code> 解析出来的参数，当然有些参数是可选的。</p>
<p>接下去我们要在构造函数也就是 <code>Hua</code> 里面格式化前缀或者后缀（如果有的话），将他们弄成只有一个汉字的格式。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(options.prefix) &#123;</span><br><span class="line">    options.prefix = options.prefix[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(!isChinese(options.prefix)) <span class="keyword">delete</span> options.prefix;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(options.suffix) &#123;</span><br><span class="line">    options.suffix = options.suffix[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(!isChinese(options.suffix)) <span class="keyword">delete</span> options.suffix;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前后缀弄好之后要对五行进行分析了。</p>
<p>如果有前后缀那么忽略五行参数。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(options.prefix &amp;&amp; options.suffix) &#123;</span><br><span class="line">    <span class="keyword">delete</span> options[<span class="string">&quot;file-elements&quot;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果有前缀，那么忽略传进来的五行的第一个五行；如果有后缀那么忽略第二个字的五行。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> wuxing = <span class="string">&quot;金木水火土&quot;</span>;</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(options.prefix) &#123;</span><br><span class="line">    options[<span class="string">&quot;five-elements&quot;</span>] = options[<span class="string">&quot;five-elements&quot;</span>].substr(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> === wuxing.indexOf(options[<span class="string">&quot;five-elements&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">delete</span> options[<span class="string">&quot;five-elements&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(options.suffix) &#123;</span><br><span class="line">    options[<span class="string">&quot;five-elements&quot;</span>] = options[<span class="string">&quot;five-elements&quot;</span>].substr(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> === wuxing.indexOf(options[<span class="string">&quot;five-elements&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">delete</span> options[<span class="string">&quot;five-elements&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果前后缀都没有，那么要格式化一下该参数，使其仅剩两个有效的五行汉字。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    options[<span class="string">&quot;five-elements&quot;</span>] = options[<span class="string">&quot;five-elements&quot;</span>].substr(<span class="number">0</span>, <span class="number">2</span>).split(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; options[<span class="string">&quot;five-elements&quot;</span>].length; i++) &#123;</span><br><span class="line">        <span class="comment">// 如果是无效五行或者冰没有这个字的话，随机一个五行出来</span></span><br><span class="line">        <span class="keyword">if</span>(-<span class="number">1</span> === wuxing.indexOf(options[<span class="string">&quot;five-elements&quot;</span>][i])) &#123;</span><br><span class="line">            options[<span class="string">&quot;five-elements&quot;</span>][i] = wuxing[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">5</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 字数不够，随机来凑</span></span><br><span class="line">    <span class="keyword">while</span>(options[<span class="string">&quot;five-elements&quot;</span>].length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        options[<span class="string">&quot;five-elements&quot;</span>].push(wuxing[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">5</span>)]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    options[<span class="string">&quot;five-elements&quot;</span>] = options[<span class="string">&quot;five-elements&quot;</span>].join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上的这些逻辑都写在构造函数里面，如果想要完整的构造函数可以看 <code>hua</code> 的 <a target="_blank" rel="noopener" href="https://github.com/BoogeeDoo/hua/blob/09f1bc7eae14faaa9e881392d3811a6073d94b1c/lib/hua.js#L14-L55">hua.js</a> 文件。</p>
<h4 id="生成一个花名"><a href="#生成一个花名" class="headerlink" title="生成一个花名"></a>生成一个花名</h4><p>生成一个花名其实就是调用 <code>randomName.names.get</code> 系列函数们了。</p>
<ul>
<li><strong>有前后缀：</strong>直接返回前缀加后缀。</li>
<li><strong>有前缀：</strong>返回前缀加 <code>get1</code>。</li>
<li><strong>有后缀：</strong>返回 <code>get1</code> 加后缀。</li>
<li><strong>没有前后缀：</strong>直接返回 <code>get2</code>。</li>
</ul>
<blockquote>
<p><strong>注意：</strong>以上情况都会传进（哪怕是 <code>undefined</code>）五行参数。</p>
</blockquote>
<p>所以 <code>generateOne</code> 函数长<a target="_blank" rel="noopener" href="https://github.com/BoogeeDoo/hua/blob/09f1bc7eae14faaa9e881392d3811a6073d94b1c/lib/hua.js#L67-L83">这样</a>：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Hua.prototype.generateOne = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.options.prefix &amp;&amp; <span class="built_in">this</span>.options.suffix) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.options.prefix + <span class="built_in">this</span>.options.suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.options.prefix) &#123;</span><br><span class="line">        debug(<span class="built_in">this</span>.options[<span class="string">&quot;five-elements&quot;</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.options.prefix + randomName.names.get1(<span class="built_in">this</span>.options[<span class="string">&quot;five-elements&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.options.suffix) &#123;</span><br><span class="line">        debug(<span class="built_in">this</span>.options[<span class="string">&quot;five-elements&quot;</span>]);</span><br><span class="line">        <span class="keyword">return</span> randomName.names.get1(<span class="built_in">this</span>.options[<span class="string">&quot;five-elements&quot;</span>]) + <span class="built_in">this</span>.options.suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> randomName.names.get2(<span class="built_in">this</span>.options[<span class="string">&quot;five-elements&quot;</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="生成-Count-个花名"><a href="#生成-Count-个花名" class="headerlink" title="生成 Count 个花名"></a>生成 Count 个花名</h4><p>还记得 CLI 的 <code>count</code> 参数么？因为为了方便，我们可以批量生成花名，所以就需要生成 Count 个花名的函数了。</p>
<p>实际上就是一个循环调用 <code>generateOne</code> 的函数而已。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Hua.prototype.generate = <span class="function"><span class="keyword">function</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!count) count = <span class="built_in">this</span>.options.count || <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        result.push(<span class="built_in">this</span>.generateOne());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="CLI-文件"><a href="#CLI-文件" class="headerlink" title="CLI 文件"></a>CLI 文件</h3><p>刚刚那个 <code>nomnom</code> 解析就在这个文件里面，然后接下去就是实例化一个 <code>Hua</code> 对象，然后生成 <code>count</code> 个花名。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> hua = <span class="keyword">new</span> Hua(opts);</span><br><span class="line"><span class="keyword">var</span> result = hua.generate();</span><br></pre></td></tr></table></figure>

<p>最后把花名输出来就好了。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot; * &quot;</span> + result[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="桥豆麻袋！"><a href="#桥豆麻袋！" class="headerlink" title="桥豆麻袋！"></a>桥豆麻袋！</h4><blockquote>
<p>说好的五行颜色呢？！</p>
</blockquote>
<p>好像是的哦，我们要在输出之前给 <code>result</code> 上个色儿。</p>
<p>遍历 <code>result</code> 里面的花名每个字，获取它的五行属性，然后涮上色儿。</p>
<p><code>chinese-random-name</code> 暴露了字典中每个字的五行属性，只需要赋值一下就好了。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> dict = <span class="built_in">require</span>(<span class="string">&quot;chinese-random-name&quot;</span>).names.dict;</span><br></pre></td></tr></table></figure>

<p>然后逐一对比。最后对应金木水火土的颜色值分别为：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> definedColors = [</span><br><span class="line">    <span class="number">220</span>, <span class="number">83</span>, <span class="number">26</span>, <span class="number">197</span>, <span class="number">59</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>220 为黄色，代表金；83 为绿色，代表木；26 蓝色代表水；197 红色代表火；59 灰色代表土。</p>
<p>如果那个字无法找到属性，则不上色，保持默认。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">result = result.map(<span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> withColor = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; wuxing.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> wx = wuxing[j];</span><br><span class="line">            <span class="keyword">if</span>(wx === <span class="string">&quot; &quot;</span>) &#123;</span><br><span class="line">                withColor += name[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(dict[wx].indexOf(name[i]) !== -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> color = <span class="keyword">new</span> Color(name[i]);</span><br><span class="line">                color.fgcolor = definedColors[j];</span><br><span class="line">                withColor += color.toString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> withColor;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>至此我们的 CLI 就写好了，最后别忘了在 <a target="_blank" rel="noopener" href="https://github.com/BoogeeDoo/hua/blob/09f1bc7eae14faaa9e881392d3811a6073d94b1c/bin/hua">hua</a> 这个 CLI 文件顶部加上一句话。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br></pre></td></tr></table></figure>

<p>这代表到时候如果要 <code>./hua</code> 的时候这个脚本是用 Node.js 来跑的。</p>
<h2 id="收拾"><a href="#收拾" class="headerlink" title="收拾"></a>收拾</h2><p>本来想好好写篇起花名的牢骚，结果不知不觉写成了给初心者看的初级教程了，泪目 ( •̥́ ˍ •̀ू )</p>
<p>不嫌弃的就这么看看吧。</p>
<p>最后这里给出我写好的这个 <code>hua</code> 程序。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ [sudo] npm install -g huaming</span><br></pre></td></tr></table></figure>

<p>然后就能在命令行下面跑了，跑法上面几章有介绍过。它的 Repo 在<a target="_blank" rel="noopener" href="https://github.com/BoogeeDoo/hua">这里</a>。</p>
<p>最后希望这个包在你们起花名的时候还真有那么一丢丢的用处。</p>
<hr><section class="comment"><div id="disqus_thread"></div></section><script>var DISQUS_PAGE_URL = "https://xcoder.in/2016/02/24/lets-hua/";</script><script>var DISQUS_IDENTIFIER = "2016/02/24/lets-hua/";</script><script>var DISQUS_SHORT_NAME = "xcoder"</script><script>var disqus_config = function() {
  this.page.url = DISQUS_PAGE_URL;
  this.page.identifier = DISQUS_IDENTIFIER;
};

(function() {
  var d = document, s = d.createElement("script");
  s.src = "https://" + DISQUS_SHORT_NAME + ".disqus.com/embed.js";
  s.setAttribute("data-timestamp", +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><footer><section class="copyright">&copy; 2016 - 2021<a href="/">死月·吃圡蕾特</a></section><section class="intro">由<a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>驱动&middot;挂载<a target="_blank" rel="noopener" href="https://github.com/xadillax/hexo-xnew">X'new</a>主题</section></footer></article></main><script src="//cdn.bootcss.com/Han/3.3.0/han.min.js"></script><script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><script src="//cdn.bootcss.com/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script><script src="/scripts/highlight.pack.js"></script><script>$(function() {
    $("header").backstretch("/images/header.jpeg");

    $("figure.highlight").each(function(i, block) {
        $(block).removeClass("highlight");
        $(block).find("td.gutter").remove();
        $("<pre><code class='__tobehl " + ($(block).attr("class") === "plain" ? "" : ("lang-" + $(block).attr("class"))) + "'></code></pre>").insertAfter($(block));
        $(block).next().find("code").text((block.innerText || block.textContent));
        $(block).remove();
    });
    $(".__tobehl").each(function(i, block) {
        hljs.highlightBlock(block);
    });

    $("article.full img").each(function() {
        if($(this).parent().is("article")) {
            $(this).wrap("<p style='text-align: center;'></p>");
        } else {
            $(this).parent().css("text-align", "center");
        }
    });

    if($(".article-toc").children().length < 2) {
        $(".article-toc").css("display", "none");
    }
});</script></body></html>
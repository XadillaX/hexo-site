

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    
    <meta name="author" content="小鳥遊死月">
    
    <meta name="description" content="前言XPlan 是一個“基於校園強關係的社交應用”的開發代號。其中有一個功能是從學校網站上通過網絡爬蟲（Web Crawler）形式將學校新聞抓取到XPlan自身的數據庫當中。
而這裏出現的一個問題就是學校網站上面的文章是通過類似於 KindEditor、UEditor這類在線富文本編輯器生成的代碼">
    
    

    
    <link rel="alternative" href="http://xcoder.in/atom.xml" title="艾克斯の編碼者" type="application/atom+xml">
    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>浙江大學XPlan項目新聞爬蟲手機屏幕適配文檔 | 艾克斯の編碼者 · 一個偽宅级别的蒟蒻碼畜。</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script> 
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://xcoder.in" title="艾克斯の編碼者">艾克斯の編碼者</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                <p class="navbar-text pull-right">一個偽宅级别的蒟蒻碼畜。</p>

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index"><a href="/">首页</a></li>
                    
                    <li id="nav-archives"><a href="/archives">归档</a></li>
                    
                    <li id="nav-tags"><a href="/tags">标签</a></li>
                    
                    <li id="nav-categories"><a href="/categories">分类</a></li>
                    
                    <li id="nav-curriculumvitae"><a href="/curriculumvitae">关于</a></li>
                    
                    <li id="nav-links"><a href="/links">链接</a></li>
                    
                    
                    <li><a href="https://github.com/XadillaX" target="_blank">GitHub</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <script>
    var backRoot = "/images/background/";
    var backArray = [ "1.jpeg", "2.jpeg", "3.jpeg", "4.jpeg", "5.jpeg", "6.jpeg", "img/iPad_Photo_20140328181354FGPM.JPG", "img/iPad_Photo_20140328181218SLUY.JPG", "img/iPad_Photo_20140328181239ME9E.JPG", "img/iPad_Photo_20140328175718BF7T.JPG", "likeit/465_16170978_35afb62980c6d1a.jpg", "likeit/wallpaper-86487.jpg", "likeit/wallpaper-651939.jpg", "likeit/wallpaper-648634.jpg", "likeit/wallpaper-657798.jpg", "likeit/wallpaper-1479749.jpg", "likeit/wallpaper-1961179.jpg", "likeit/wallpaper-1947874.jpg", "likeit/wallpaper-2055407.jpg", "likeit/wallpaper-2060090.png", "likeit/wallpaper-2142870.jpg", "likeit/wallpaper-2078006.jpg", "likeit/wallpaper-2127699.jpg", "likeit/wallpaper-2211066.jpg", "likeit/wallpaper-2588686.jpg", "likeit/wallpaper-2639031.jpg", "likeit/wallpaper-2430341.jpg", "likeit/wallpaper-2294985.jpg", "likeit/wallpaper-2705897.jpg", "likeit/wallpaper-2063319.jpg", "likeit/wallpaper-2060101.jpg", "likeit/wallpaper-1970791.jpg", "img/iPad_Photo_20140328174508AZ11.JPG", "img/new/iPad_Photo_201403281903078UKK.JPG", "img/iPad_Photo_20140328175639RA5N.JPG", "img/iPad_Photo_20140328175820DYAC.JPG", "img/iPad_Photo_201403281806230195.JPG", "img/new/iPad_Photo_201403281919292STQ.JPG", "img/new/iPad_Photo_20140328190703781D.JPG", "flandre/p541758_2girls barefoot bat_wings bed blonde_hair blue_hair feet fetal_position flandre_scarlet flat_chest hat nude red_eyes ~.jpg", "flandre/p575023_blonde_hair flandre_scarlet hat horumon multiple_persona ponytail red_eyes side_ponytail touhou wings.jpg", "flandre/p569665_2girls barefoot blonde_hair blue_hair flandre_scarlet hat highres kinoko red_eyes remilia_scarlet siblings sisters to~.jpg", "flandre/p566082_blonde_hair flandre_scarlet hat mitsuki_(artist) ponytail red_eyes short_hair side_ponytail touhou wings.jpg", "flandre/p548132_2girls bat_wings blonde_hair blue_eyes blue_hair flandre_scarlet hat kaedena_akino mask moon red_eyes red_moon remili~.jpg", "flandre/p552906_flandre_scarlet gusutafu hong_meiling izayoi_sakuya koakuma patchouli_knowledge remilia_scarlet swimsuit touhou.jpg", "flandre/p551605_flandre_scarlet kona-ta touhou.jpg", "flandre/p551983_asuka_roze danmaku flandre_scarlet remilia_scarlet touhou.jpg", "likeit/465_16170978_2b89f5997bcff44.jpg", "likeit/wallpaper-616321.jpg", "likeit/wallpaper-343717.jpg", "likeit/wallpaper-1595016.jpg", "likeit/wallpaper-1952396.jpg", "likeit/wallpaper-2060096.jpg", "likeit/wallpaper-2315398.jpg", "likeit/wallpaper-2674370.jpg", "likeit/wallpaper-2838683.jpg", "likeit/wallpaper-2564028.png", "likeit/wallpaper-1382762.jpg", "likeit/wallpaper-1128042.jpg", "likeit/wallpaper-1396368.jpg", "likeit/wallpaper-1403569.png", "likeit/wallpaper-1593633.jpg", "likeit/wallpaper-1395408.jpg", "flandre/p539131_blonde_hair flandre_scarlet hat plastic_eraser red_eyes scenery short_hair solo touhou.jpg", "flandre/p555228_flandre_scarlet hong_meiling izayoi_sakuya patchouli_knowledge remilia_scarlet shomon swimsuit touhou.jpg", "flandre/p556145_book flandre_scarlet flower hairband hakurei_reimu hat hitoto hong_meiling izayoi_sakuya kirisame_marisa koakuma patc~.jpg", "flandre/p561220_arikichi_gen blonde_hair blue_eyes blue_hair braid flandre_scarlet izayoi_sakuya ponytail red_eyes remilia_scarlet sh~.jpg", "flandre/p541363_blonde_hair flandre_scarlet hat laevatein magic_circle poncho_(pixiv) red_eyes side_ponytail touhou wings.jpg",  ];
        
    $(function() {
        // page-id...
        var pageId = "2013/12/28/xplan-spider-doc/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";
        
        $("#nav-" + pageId).addClass("active");
    });
    </script>

    <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>浙江大學XPlan項目新聞爬蟲手機屏幕適配文檔</h1>
        
        <div class="time-info">
发表于:<time datetime="2013-12-27T16:00:00.000Z" itemprop="datePublished">2013年12月28日</time>，更新于:<time datetime="2016-07-09T11:17:54.000Z" itemprop="dateModified">2016年07月09日</time>，By <a href="http://xcoder.in" title="小鳥遊死月">小鳥遊死月</a>
        </div>
        
        <div class="post-body-inner">
            <div id="toc" class="toc-article well">
                <strong class="toc-title">大纲</strong>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#預處理"><span class="toc-number">2.</span> <span class="toc-text">預處理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Viewport"><span class="toc-number">2.1.</span> <span class="toc-text">Viewport</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#width"><span class="toc-number">2.1.1.</span> <span class="toc-text">width</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#height"><span class="toc-number">2.1.2.</span> <span class="toc-text">height</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#initial-scale"><span class="toc-number">2.1.3.</span> <span class="toc-text">initial-scale</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#maximum-scale"><span class="toc-number">2.1.4.</span> <span class="toc-text">maximum-scale</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#user-scaleble"><span class="toc-number">2.1.5.</span> <span class="toc-text">user-scaleble</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cheerio模塊*"><span class="toc-number">3.</span> <span class="toc-text">Cheerio模塊*</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bootstrap"><span class="toc-number">4.</span> <span class="toc-text">Bootstrap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#細節處理"><span class="toc-number">5.</span> <span class="toc-text">細節處理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#<img_/>"><span class="toc-number">5.1.</span> <span class="toc-text"><img /></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#<table></table>"><span class="toc-number">5.2.</span> <span class="toc-text"><table></table></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#<a_/>"><span class="toc-number">5.3.</span> <span class="toc-text"><a /></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#結束語"><span class="toc-number">6.</span> <span class="toc-text">結束語</span></a></li></ol>
            </div>
            
            <h2 id="前言">前言</h2><p><strong>XPlan</strong> 是一個“基於校園強關係的社交應用”的開發代號。其中有一個功能是從學校網站上通過網絡爬蟲（Web Crawler）形式將學校新聞抓取到XPlan自身的數據庫當中。</p>
<p>而這裏出現的一個問題就是學校網站上面的文章是通過類似於 <a href="http://kindeditor.net/" target="_blank" rel="external"><code>KindEditor</code></a>、<a href="http://ueditor.baidu.com/website/" target="_blank" rel="external"><code>UEditor</code></a>這類<strong>在線富文本編輯器</strong>生成的代碼。</p>
<p>這類代碼有幾個共性：</p>
<ol>
<li>代碼有大量冗餘、多重無用嵌套。</li>
<li>非常低的代碼可讀性。</li>
<li>在PC瀏覽器中表現力不錯，往往能以低效的代碼實現預期排版。</li>
</ol>
<p>所以這些富文本編輯器可以在PC各大內核瀏覽器中表現良好，但是不便人工修改代碼。</p>
<p>而 <strong>XPlan</strong> 確是一個由智能手機主導的應用，新聞將會通過一個 <strong>WebView</strong> 體現出來。所以就需要一定的方法將這些髒亂的代碼適配成手機屏幕下表現力良好的代碼。</p>
<h2 id="預處理">預處理</h2><p>在這裏，我們將新聞的代碼鎖定在新聞內容排版，而排除了其它類似於新聞標題、新聞作者等其它信息。</p>
<p>以我們浙江大學軟件學院爲例，我們爬取的新聞內容代碼將如下：</p>
<figure class="highlight applescript"><figcaption><span>html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"vid_wz"</span>&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p>所有內容將被包括在這個類型爲 <code>vid_wz</code> 的 <code>div</code> 當中。</p>
<p>這時，我們將其包括在一個自己實現定義好的模板當中。該模板與新聞內容將會形成一個完整的網頁，包括完整的 <code>html</code>、<code>head</code>、<code>body</code> 等標籤。</p>
<figure class="highlight xml"><figcaption><span>html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>新聞內頁<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"viewport"</span> <span class="attribute">content</span>=<span class="value">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">http-equiv</span>=<span class="value">"Content-Type"</span> <span class="attribute">content</span>=<span class="value">"text/html; charset=UTF-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">article</span> <span class="attribute">id</span>=<span class="value">"_xplan-wrapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"vid_wz"</span>&gt;</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">article</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>這裏需要注意的一點的就是其中的一個 <code>meta</code> 標籤：</p>
<figure class="highlight applescript"><figcaption><span>html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta <span class="property">name</span>=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p>它的意思是定義 <code>viewport</code> 的一些屬性，實現了初步的手機網頁適配。</p>
<h3 id="Viewport">Viewport</h3><p>手機瀏覽器是把頁面放在一個虛擬窗口（即 <code>viewport</code>）中，用戶可以通過平移和縮放來看網頁的不同部分。</p>
<p>通過 <code>viewport</code> 我們能對頁面的一些縮放進行手機適配。</p>
<p>我們所需要做的僅是在 <code>head</code> 中插入一個 <code>meta</code> 標籤，命名爲 <code>viewport</code>，然後定義好其 <code>content</code>。</p>
<p><code>content</code> 的語法如下：</p>
<h4 id="width">width</h4><p>控制 <code>viewport</code> 的寬度，可以指定一個值或者特殊的值，如 <code>device-width</code> 爲設備寬度。</p>
<h4 id="height">height</h4><p>與 <code>width</code> 相對應，指定高度</p>
<h4 id="initial-scale">initial-scale</h4><p>初始縮放，即頁面初始縮放程度。這是一個浮點值，是頁面大小的一個乘數。例如，如果你設置初始縮放爲 <code>1.0</code>，那麼頁面在展現的時候就會以分辨率的1:1來展現。如果你設置爲<code>2.0</code>，那麼這個頁面就會放大爲2倍。</p>
<h4 id="maximum-scale">maximum-scale</h4><p>最大放大倍數。</p>
<h4 id="user-scaleble">user-scaleble</h4><p>用戶調整縮放，即用戶是否能改變頁面縮放程度。如果爲 <code>yes</code> 即爲可以， <code>no</code> 爲不可以。</p>
<h2 id="Cheerio模塊*">Cheerio模塊*</h2><p>由於 <strong>XPlan</strong> 的後端是基於 <code>node.js</code> 構架的，所以 <strong>cheerio</strong> 模塊是一個 <code>node.js</code> 專有的模塊。</p>
<p>它的作用是將一段HTML代碼轉換爲一棵DOM元素樹。</p>
<p>在其官網上是這麼詮釋的：爲服務端定製的快速、靈活、輕量級實現的 jQuery 內核。通常熟悉 jQuery 使用的開發者應該會對其使用方法比較熟悉。</p>
<p>所以在我們做接下去適配修改的之前，我們需要將我們剛纔生成的完整HTML代碼 轉換爲一棵我們可以操作的DOM元素樹。</p>
<figure class="highlight lasso"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">var</span> cheerio = <span class="keyword">require</span>(<span class="string">"cheerio"</span>);</span><br><span class="line">$ = cheerio<span class="built_in">.</span>load(<span class="attribute">...</span>);</span><br></pre></td></tr></table></figure>
<p>這時我們便能以熟悉的jQuery模式對其進行操作了，如：</p>
<figure class="highlight elixir"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span><span class="string">"p"</span>).html(<span class="string">"hello foo!"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="Bootstrap">Bootstrap</h2><p>Bootstrap是Twitter推出的一個開源的用於前端開發的工具包。它有一個非常好的響應式的頁面風格，使其在個尺寸屏幕上表現良好。</p>
<p>爲了能更好適應屏幕，我們決定採用其自帶的柵格系統，於是剛纔的頁面模板就有了新的變化：</p>
<figure class="highlight xml"><figcaption><span>html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>新聞內頁<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"viewport"</span> <span class="attribute">content</span>=<span class="value">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">http-equiv</span>=<span class="value">"Content-Type"</span> <span class="attribute">content</span>=<span class="value">"text/html; charset=UTF-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">article</span> <span class="attribute">class</span>=<span class="value">"container"</span> <span class="attribute">id</span>=<span class="value">"_xplan-wrapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-md-12"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"vid_wz"</span>&gt;</span>...<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">article</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>首先最外框的 <code>container</code>，用其包裹的元素將實現居中對齊。在不同的媒體查詢閾值範圍內都爲 <code>container</code> 設置了 <code>width</code>，用以匹配柵格系統。</p>
<p><code>row</code> 是一行柵格系統的外包元素。一行可以有12個柵格。</p>
<p>以 <code>.col-md-</code> 開頭的柵格的最大 <code>container</code> 寬度爲970，最大列寬爲78，並能自適應屏幕。</p>
<h2 id="細節處理">細節處理</h2><p>在完成了以上操作以後，我們將對各元素進行微調處理。</p>
<p>好在在手機瀏覽器或者 <code>WebView</code> 中，對各種字體的設置不是非常敏感，所以我們仍然可以不處理一些關於字體變更的設置，以減輕開髮量。</p>
<p>這裏距幾個微調的例子。</p>
<h3 id="&lt;img_/&gt;">&lt;img /&gt;</h3><p>在新聞當中，圖片充當的基本上是新聞照片的角色，在手機當中以單行出現爲佳。</p>
<p>而 Bootstrap 當中本身就有元素類型來讓圖片元素響應屏幕寬度，並可以加上圓角邊框。</p>
<p>所以我們需要做的就是爲所有圖片加上響應的類型：</p>
<figure class="highlight elixir"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span><span class="string">"img"</span>).addClass(<span class="string">"img-thumbnail"</span>);</span><br><span class="line"><span class="variable">$(</span><span class="string">"img"</span>).addClass(<span class="string">"img-responsive"</span>);</span><br><span class="line"><span class="variable">$(</span><span class="string">"img"</span>).removeAttr(<span class="string">"style"</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意：</strong> 最後的一個移除 <code>img</code> 元素自帶的 <code>style</code> 屬性是因爲在文章發佈的時候，有可能會被富文本編輯器自動加上一些寬高、邊框等信息。爲了統一所有圖片風格以及讓響應式生效，需要將其 <code>style</code> 屬性全部移除。</p>
</blockquote>
<p>下面是是適配前與適配後的對比：</p>
<p><img src="./xplan-news-2.jpg" alt="適配前"><br><img src="./xplan-news-1.jpg" alt="適配後"></p>
<h3 id="&lt;table&gt;&lt;/table&gt;">&lt;table&gt;&lt;/table&gt;</h3><p>對於 <code>table</code> 元素也需要對它進行自適配，不然很有可能會溢出屏幕，使其多出了一個橫向的滾動條。</p>
<figure class="highlight elixir"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span><span class="string">"table"</span>).removeAttr(<span class="string">"style"</span>);</span><br><span class="line"><span class="variable">$(</span><span class="string">"table"</span>).removeAttr(<span class="string">"border"</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$(</span><span class="string">"table"</span>).addClass(<span class="string">"table"</span>);</span><br><span class="line"><span class="variable">$(</span><span class="string">"table"</span>).addClass(<span class="string">"table-bordered"</span>);</span><br><span class="line"><span class="variable">$(</span><span class="string">"table"</span>).addClass(<span class="string">"table-striped"</span>);</span><br></pre></td></tr></table></figure>
<p>上面兩句是移除 <code>table</code> 的原有的一些風格信息以及屬性。後面是爲其加上 Bootstrap 特有的 <code>table</code> 類型。</p>
<p>當然，更多的 <code>table</code> 元素還需要其它更多操作。不過就目前爲止，<strong>XPlan</strong> 還沒有着手關於 <code>table</code> 的更深一層容錯處理。不過這裏可以提供一個思路。</p>
<p>比如說 <a href="http://www.cst.zju.edu.cn/index.php?c=Index&amp;a=detail&amp;catid=72&amp;id=1885" target="_blank" rel="external">這篇文章中</a>，不知道是誰給的在線富文本編輯器勇氣，使其下面幾張圖片都各自被一個 <code>table</code> 及其子元素所包含。更有甚者，有一篇文章的一個段落被一個 <code>table</code> 所包容，並且在其左側還有一個看不見的 <code>td</code> 元素。</p>
<p>我們可以提供的思路就是如果一個 <code>table</code> 只有一行一列就直接將其內容取出並刪除該 <code>table</code> 。</p>
<h3 id="&lt;a_/&gt;">&lt;a /&gt;</h3><p>超鏈接元素是一個新聞與用戶互動的比較重要的元素之一。我們需要保持其美觀性。</p>
<p>舉幾個例子來說，我們可以將超鏈接以一個類按鈕的形式出現：</p>
<figure class="highlight smalltalk"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="char">$(</span><span class="comment">"a"</span>).removeAttr(<span class="comment">"style"</span>);</span><br><span class="line"><span class="char">$(</span><span class="comment">"a"</span>).addClass(<span class="comment">"btn btn-default btn-xs btn-info"</span>);</span><br></pre></td></tr></table></figure>
<p>然後我們甚至可以對其做一些細微的詞彙修改。</p>
<p>比如當新聞發佈者上傳了一個附件然後不負責任地直接將文件名貼上的時候，我們可以貼心地將其顯示文字改爲“下載附件”。</p>
<p>再比如發佈者直接以URL形式顯示一個超鏈接的時候，我們可以貼心地將其改變爲“打開鏈接”等等。</p>
<figure class="highlight javascript"><figcaption><span>javascript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"a"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">idx, elem</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($(<span class="keyword">this</span>).html().match(<span class="regexp">/.*\.(doc|xls|ppt|docx|xlsx|pptx)/</span>)) &#123;</span><br><span class="line">        $(<span class="keyword">this</span>).html(<span class="string">"&lt;i class='glyphicon glyphicon-paperclip'&gt;&lt;/i&gt; 下載附件"</span>);</span><br><span class="line">        $(<span class="keyword">this</span>).removeClass(<span class="string">"btn-info"</span>);</span><br><span class="line">        $(<span class="keyword">this</span>).addClass(<span class="string">"btn-warning"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>($(<span class="keyword">this</span>).html().match(<span class="regexp">/http.*\/\/.*/</span>)) &#123;</span><br><span class="line">        $(<span class="keyword">this</span>).html(<span class="string">"&lt;i class='glyphicon glyphicon-flag'&gt;&lt;/i&gt; 打開鏈接"</span>);</span><br><span class="line">        $(<span class="keyword">this</span>).removeClass(<span class="string">"btn-info"</span>);</span><br><span class="line">        $(<span class="keyword">this</span>).addClass(<span class="string">"btn-warning"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然後我們再處理幾個由於誤操作而增加的錯誤鏈接，如在經上面操作後，還存在着url與顯示內容相關的超鏈接可以直接取消，如這類：</p>
<figure class="highlight xml"><figcaption><span>html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">讓我們蕩<span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"起雙槳"</span>&gt;</span>起雙槳<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="結束語">結束語</h2><p>至此，當下版本的 <strong>XPlan</strong> 的新聞爬蟲手機屏幕適配基本完成。其中當然還存在着一些細節處理和顯示錯誤處理的不足，但是已經定下了基本的適配思路。</p>
<p>我們還在探索更好的適配方法，而當下的適配形式暫時已經可以滿足了我們項目的需求。</p>


			
            <section class="comment">
<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="/2013/12/28/xplan-spider-doc/" data-title="浙江大學XPlan項目新聞爬蟲手機屏幕適配文檔" data-url="http://xcoder.in/2013/12/28/xplan-spider-doc/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"xcoder-ghost"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</section>
        </div>
    </div>
</article>

    <footer id="footer">
    <div id="bottom-tip">
        艾克斯の編碼者 —— <small>一個偽宅级别的蒟蒻碼畜。</small>
    </div>
        <small>该博客由 <a href="https://hexo.io/" target="_blank">Hexo</a> 强力驱动，搭载 <a href="https://github.com/XadillaX/hexadillax" target="_blank">Hexadillax</a> 主题</small><br />
        <small>&copy; 2014 小鳥遊死月</small>
    </footer>

    
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?d4417d158ec17db3ca549b508c2e5e07";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>



</body>
</html>

